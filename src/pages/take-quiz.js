import Head from 'next/head';
import styles from '../styles/Home.module.css';
import { useRouter } from 'next/router';
import { useState } from 'react';
import Link from 'next/link';
import { Box, AppBar, Toolbar, Typography, Button } from '@mui/material';


export default function TakeQuiz() {

  // these values come from read-paper.js
  const router = useRouter();
  const showPaper1 = router.query.showPaper1;
  const showPaper2 = router.query.showPaper2;
  const showPaper3 = router.query.showPaper3;

  // variables based on user input 
  const [paper1Value, setPaper1Value] = useState('');
  const [paper2Value, setPaper2Value] = useState('');
  const [paper3Value, setPaper3Value] = useState('');
  const [showScore, setShowScore] = useState(false);
  const [totalQuestions, setTotalQuestions] = useState('');
  const [totalCorrect, setCorrect] = useState('');



  // handle paper 1 change 
  const handlePaper1Change = (event) => {
    setPaper1Value(event.target.value);
  }

  // handle paper 2 change
  const handlePaper2Change = (event) => {
    setPaper2Value(event.target.value);
  }

  // handle paper 3 change
  const handlePaper3Change = (event) => { 
    setPaper3Value(event.target.value);
  }

  const scoreFun = () => {

    let totalCorrect = 0;
    let totalQuestions = 0;
    
    // correct answers to v2 quiz
    const correctAnswerPaper1 = 'paper1-c';
    const correctAnswerPaper2 = 'paper2-a';
    const correctAnswerPaper3 = 'paper3-c';
    console.log("input-", paper1Value, paper2Value, paper3Value);
    // get all the choices the user selected
    if (showPaper1 === 'true') {
   //  console.log( "q1-", gmaiValue === correctAnswerPaper1);
     totalQuestions += 1;

     if (paper1Value === correctAnswerPaper1) {
      totalCorrect += 1;
     }
    }

    if (showPaper2 === 'true')  {
    //  console.log("q2-", fhirValue, correctAnswerPaper2);
      totalQuestions += 1;

      if (paper2Value === correctAnswerPaper2) {
        totalCorrect += 1;
      }
    }

    if (showPaper3 === 'true') {
     // console.log("q3-", yfValue, correctAnswerPaper3);
      totalQuestions += 1;

      if (paper3Value === correctAnswerPaper3) {
        totalCorrect += 1;
      }
    }

    console.log("total correct-", totalCorrect, "total questions-", totalQuestions);
    setTotalQuestions(totalQuestions);
    setCorrect(totalCorrect);

  }


 return (
   <div className={styles.container}>
      <Head>
        <title>Let's Go Biotech - Quiz</title>
        <meta name="description" content="Generated by create next app" />
        {/* <link rel="icon" href="/favicon.ico" /> */}
      </Head>

      <AppBar position="fixed" color="secondary">
        <Toolbar>
          <Typography variant="h6" component="div" sx={{ flexGrow: 1 }}>
            LGB ðŸ§¬ use on a laptop or desktop monitor
          </Typography>
        </Toolbar>
      </AppBar>

       <Typography variant="h1" sx={{ mb: 4 }}>
        ðŸ§¬ <b>Let's Go Biotech</b> ðŸš€
      </Typography>
      <br />

      <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
       Instructions &rarr; Check an answer BEFORE clicking on the green button 
      </Typography>

      {showPaper1 === 'true' && (
        <div className={styles.quizHellYa}>
          <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
          <span><i><b>What potential impact could the development of efficient CRISPR RNA-LNPs for lung gene editing have on the treatment of inherited lung diseases?</b></i></span><br />
          <input type="radio" id="paper1-a" name="paper1" value="paper1-a" onChange={handlePaper1Change}/>
          <label htmlFor="paper1-a">CRISPR RNA-LNPs will only be effective in treating a small subset of inherited lung diseases.</label><br />
          <input type="radio" id="paper1-b" name="paper1" value="paper1-b" onChange={handlePaper1Change} />
          <label htmlFor="paper1-b">The development of CRISPR RNA-LNPs will have no impact on inherited lung diseases.</label><br />
          <input type="radio" id="paper1-c" name="paper1" value="paper1-c" onChange={handlePaper1Change} />
          <label htmlFor="paper1-c">Effective CRISPR RNA-LNPs could provide a transformative treatment for inherited lung diseases and enable further gene therapy applications in the respiratory system.</label><br />
          </Typography>
        </div>
      )}

      <br />

      {showPaper2 === 'true' && (
        <div className={styles.quizHellYa}>
          <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
          <span><i><b>What is the primary benefit of simultaneous reading of genetic and epigenetic bases?</b></i></span><br />
          <input type="radio" id="paper2-a" name="paper2" value="paper2-a" onChange={handlePaper2Change} />
          <label htmlFor="paper2-a">It provides a more complete picture of the information stored in genome</label><br />
          <input type="radio" id="paper2-b" name="paper2" value="paper2-b" onChange={handlePaper2Change} />
          <label htmlFor="paper2-b">Preventing cytosine modifications</label><br />
          <input type="radio" id="paper2-c" name="paper2" value="paper2-c" onChange={handlePaper2Change} />
          <label htmlFor="paper2-c">Cell Free DNA has the answers</label><br />
          </Typography>
        </div>
      )}

      <br />

      {showPaper3 === 'true' && (
        <div className={styles.quizHellYa}>
          <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
          <span><b>How are biotechs exploring the use of text generation engines like OpenAIâ€™s ChatGPT, and what impact could this have on drug discovery?</b></span><br />
          <input type="radio" id="  " name="paper3" value="paper3-a" onChange={handlePaper3Change} />
          <label htmlFor="paper3-a">Biotechs are not interested in using text generation engines for drug discovery.</label><br />
          <input type="radio" id="paper3-b" name="paper3" value="paper3-b" onChange={handlePaper3Change} />
          <label htmlFor="paper3-b">Text generation engines like OpenAIâ€™s ChatGPT can only contribute to drug discovery in limited ways.</label><br />
          <input type="radio" id="paper3-c" name="paper3" value="paper3-c" onChange={handlePaper3Change}/>
          <label htmlFor="paper3-c">Biotechs are exploring the use of text generation engines like OpenAIâ€™s ChatGPT to bolster their businesses and enhance drug discovery.</label><br />
          </Typography>
        </div>
      )} 

      <br />
      <br />


      {showScore && totalCorrect > 0 &&(
        <div className={styles.quizHellYa}>
          <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
            Great job on reading new & hard material completing the quiz! < br />
            You got {totalCorrect} correct out of {totalQuestions}! <br />

            <br />
            
            <Link className={styles.greenSquare} href="/select-paper" >
                <h2>Let's Try a New One!</h2>
            </Link>

          </Typography>
        </div>
      )}

      {showScore && totalCorrect === 0 && (
        <div className={styles.quizHellYa}>
          <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
              Great job on reading the paper and trying to understand something complicated! < br />
              You didn't get any of the questions correct, no worries! <br /> <br />
              Re-read the abstract &darr; and try again!<br />
            <Link className={styles.greenSquare} href="/select-paper">
            <h2>Back to Paper Selection!</h2>
            </Link> <br />
          </Typography>
        </div>
      )}

      {!showScore && (
      <Typography variant="body1" sx={{ mb: 2, fontSize: "1.5rem" }}>
        <Link className={styles.greenSquare} href="#" onClick={() => [ scoreFun() , setShowScore(true)]}>
            <h2>Finished? Let's See How You Did!</h2>
        </Link>
      </Typography>
      )}

   </div>
 )
}
